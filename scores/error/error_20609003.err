Loaded dependency [python3/3.10.12]: gcc/11.4.0-binutils-2.40
Loaded dependency [python3/3.10.12]: sqlite3/3.42.0

Switching from python3/3.8.2 to python3/3.10.12
  Loading requirement: gcc/11.4.0-binutils-2.40 sqlite3/3.42.0
2024-03-16 09:04:15.642507: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-16 09:04:15.642607: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-16 09:04:15.666179: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-16 09:05:15.729484: W external/xla/xla/service/hlo_rematerialization.cc:2202] Can't reduce memory use below 11.82GiB (12696256512 bytes) by rematerialization; only reduced to 12.29GiB (13198184196 bytes), down from 12.30GiB (13206572936 bytes) originally
2024-03-16 09:05:27.293846: W external/tsl/tsl/framework/bfc_allocator.cc:485] Allocator (GPU_0_bfc) ran out of memory trying to allocate 12.51GiB (rounded to 13433399296)requested by op 
2024-03-16 09:05:27.294762: W external/tsl/tsl/framework/bfc_allocator.cc:497] **__________________________________________________________________________________________________
2024-03-16 09:05:27.295252: E external/xla/xla/pjrt/pjrt_stream_executor_client.cc:2593] Execution of replica 0 failed: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 13433399136 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:   42.18MiB
              constant allocation:    5.70MiB
        maybe_live_out allocation:   34.18MiB
     preallocated temp allocation:   12.51GiB
  preallocated temp fragmentation:  250.78MiB (1.96%)
                 total allocation:   12.59GiB
              total fragmentation:  290.27MiB (2.25%)
Peak buffers:
	Buffer 1:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 2:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 3:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 4:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 5:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 6:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 7:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 8:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 9:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 10:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 11:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 12:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 13:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 14:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 15:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================


jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/train_score.py", line 298, in <module>
    train_score()
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/train_score.py", line 222, in train_score
    train_s2(M=M,
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/jaxgeometry/statistics/score_matching/trainxt.py", line 234, in train_s2
    new_state, loss_val = update(state, data)
jaxlib.xla_extension.XlaRuntimeError: RESOURCE_EXHAUSTED: Out of memory while trying to allocate 13433399136 bytes.
BufferAssignment OOM Debugging.
BufferAssignment stats:
             parameter allocation:   42.18MiB
              constant allocation:    5.70MiB
        maybe_live_out allocation:   34.18MiB
     preallocated temp allocation:   12.51GiB
  preallocated temp fragmentation:  250.78MiB (1.96%)
                 total allocation:   12.59GiB
              total fragmentation:  290.27MiB (2.25%)
Peak buffers:
	Buffer 1:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 2:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 3:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 4:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 5:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 6:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 7:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 8:
		Size: 800.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.255"
		XLA Label: fusion
		Shape: f32[262144,800]
		==========================

	Buffer 9:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 10:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 11:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 12:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 13:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 14:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================

	Buffer 15:
		Size: 400.00MiB
		Operator: op_name="jit(update)/jit(main)/jvp(jit(loss_fun))/vmap(mlp_s2)/sequential/tanh" source_file="/zhome/77/8/118225/.local/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=127 deduplicated_name="fusion.254"
		XLA Label: fusion
		Shape: f32[262144,400]
		==========================


2024-03-16 09:05:27.575224: W tensorflow/core/kernels/data/generator_dataset_op.cc:108] Error occurred when finalizing GeneratorDataset iterator: FAILED_PRECONDITION: Python interpreter state is not initialized. The process may be terminated.
	 [[{{node PyFunc}}]]
