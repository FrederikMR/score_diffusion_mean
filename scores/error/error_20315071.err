Loaded dependency [python3/3.10.12]: gcc/11.4.0-binutils-2.40
Loaded dependency [python3/3.10.12]: sqlite3/3.42.0

Switching from python3/3.8.2 to python3/3.10.12
  Loading requirement: gcc/11.4.0-binutils-2.40 sqlite3/3.42.0
2024-02-19 14:31:50.860277: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-02-19 14:31:50.860356: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-02-19 14:31:50.863817: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
Traceback (most recent call last):
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/train_score.py", line 545, in <module>
    train_score()
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/train_score.py", line 475, in train_score
    train_s2(M=M,
  File "/zhome/77/8/118225/Desktop/Projects/score_diffusion_mean/score_diffusion_mean/jaxgeometry/statistics/score_matching/trainxt.py", line 325, in train_s2
    np.save(os.path.join(save_path, "loss_arrays.npy"), jnp.stack(loss))
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 1797, in stack
    new_arrays.append(expand_dims(a, axis))
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/numpy/lax_numpy.py", line 903, in expand_dims
    return lax.expand_dims(a, axis)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 1336, in expand_dims
    return broadcast_in_dim(array, result_shape, broadcast_dims)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/lax/lax.py", line 803, in broadcast_in_dim
    return broadcast_in_dim_p.bind(
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/core.py", line 385, in bind
    return self.bind_with_trace(find_top_trace(args), args, params)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/core.py", line 388, in bind_with_trace
    out = trace.process_primitive(self, map(trace.full_raise, args), params)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/core.py", line 868, in process_primitive
    return primitive.impl(*tracers, **params)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/dispatch.py", line 140, in apply_primitive
    return compiled_fun(*args)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/dispatch.py", line 172, in <lambda>
    return lambda *args, **kw: call(*args, **kw)[0]
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/profiler.py", line 340, in wrapper
    return func(*args, **kwargs)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1140, in __call__
    input_bufs = self.in_handler(args)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 1046, in __call__
    return self.handler(input_buffers)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/profiler.py", line 340, in wrapper
    return func(*args, **kwargs)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 146, in shard_args
    return [shard_arg(arg, devices, indices[i], shardings[i])
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 146, in <listcomp>
    return [shard_arg(arg, devices, indices[i], shardings[i])
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 122, in shard_arg
    return shard_arg_handlers[type(arg)](arg, devices, arg_indices, sharding)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 166, in _shard_array
    return batched_device_put(aval, sharding, [x[i] for i in indices], devices)
  File "/zhome/77/8/118225/.local/lib/python3.10/site-packages/jax/_src/interpreters/pxla.py", line 186, in batched_device_put
    return xc.batched_device_put(aval, sharding, xs, devices, committed)  # type: ignore
KeyboardInterrupt
terminate called without an active exception
/zhome/77/8/118225/.lsbatch/1708349229.20315071.shell: line 37: 11308 Aborted                 python3 train_score.py --manifold SPDN --dim 2 --loss_type dsm --load_model 0 --T_sample 0 --t 0.01 --train_net s2 --max_T 1.0 --lr_rate 0.001 --epochs 50000 --x_samples 64 --t_samples 256 --repeats 16 --samples_per_batch 32 --dt_steps 1000 --save_step 10 --seed 2712
